# SimWidget Panel for MSFS 2024

A toolbar panel for Microsoft Flight Simulator 2024 that displays real-time flight data and provides quick controls for aircraft systems and lights.

## Features

### Flight Data Display
- **Altitude** - Current altitude in feet
- **Speed** - Indicated airspeed in knots
- **Heading** - Magnetic heading in degrees
- **Vertical Speed** - Rate of climb/descent in feet per minute

### Systems Control
- **P.BRK** - Toggle parking brake (click to toggle)
- **GEAR** - Toggle landing gear (click to toggle)
- **FLAPS** - Toggle flaps up/down (click to toggle)

### Lights Control
- **NAV** - Navigation lights
- **BCN** - Beacon lights
- **STRB** - Strobe lights
- **LDG** - Landing lights
- **TAXI** - Taxi lights

All light buttons are clickable to toggle on/off. Green indicator = ON, Gray = OFF.

### Engine Status
- **Status** - Engine combustion state (ON/OFF)
- **Throttle** - Current throttle position percentage

### Additional
- **Local Time** - Simulator local time display

## Installation

### Option 1: Pre-built Package
1. Copy the `Packages/simwidget-panel` folder to your MSFS Community folder:
   - Microsoft Store: `%LOCALAPPDATA%\Packages\Microsoft.Limitless_8wekyb3d8bbwe\LocalCache\Packages\Community\`
   - Steam: `%APPDATA%\Microsoft Flight Simulator\Packages\Community\`

2. Start MSFS 2024
3. Look for the **SimWidget** icon in the toolbar

### Option 2: Build from Source
1. Open MSFS 2024 with Dev Mode enabled
2. Open Project Editor
3. File → Open Project → Select `simwidget-panel.xml`
4. Project → Build All (F7)
5. Copy built package from `Packages/simwidget-panel` to Community folder

## Usage

1. Start a flight in MSFS 2024
2. Move mouse to top of screen to reveal toolbar
3. Click the **SimWidget** icon (blue square with lines)
4. Panel opens with live flight data
5. Click toolbar icon again to close

## Project Structure

```
msfs-panel/
├── simwidget-panel.xml              # SDK Project file
├── PackageDefinitions/
│   └── simwidget-panel.xml          # Package definition with asset groups
├── PackageSources/
│   ├── html_ui/
│   │   ├── icons/toolbar/
│   │   │   └── ICON_SIMWIDGET.svg   # Toolbar icon
│   │   └── InGamePanels/SimWidgetPanel/
│   │       ├── index.html           # Panel HTML/CSS
│   │       └── SimWidgetPanel.js    # SimVar integration
│   └── InGamePanels/
│       └── simwidget_panel.xml      # Panel registration (builds to .spb)
└── Packages/
    └── simwidget-panel/             # Built package (copy to Community)
        ├── manifest.json
        ├── layout.json
        ├── html_ui/
        └── InGamePanels/
            └── simwidget_panel.spb  # Compiled panel registration
```

## Technical Details

### MSFS 2024 Panel Requirements
- Panels require a compiled `.spb` (SimBase Package Binary) file
- The `.spb` is generated by the SDK from the XML panel definition
- Panel registration XML defines: ID, name, icon, and HTML URL
- HTML uses MSFS's Coherent UI framework with `<ingame-ui>` component

### SimVar Integration
The panel uses MSFS's JavaScript SimVar API:
- `SimVar.GetSimVarValue(name, unit)` - Read aircraft state
- `SimVar.SetSimVarValue(name, unit, value)` - Send commands (K: events)

### Key SimVars Used
| SimVar | Description |
|--------|-------------|
| PLANE ALTITUDE | Current altitude |
| AIRSPEED INDICATED | Indicated airspeed |
| PLANE HEADING DEGREES MAGNETIC | Magnetic heading |
| VERTICAL SPEED | Vertical speed |
| BRAKE PARKING POSITION | Parking brake state |
| GEAR HANDLE POSITION | Gear handle state |
| FLAPS HANDLE INDEX | Flaps position |
| LIGHT NAV/BEACON/STROBE/LANDING/TAXI | Light states |
| ENG COMBUSTION:1 | Engine running state |
| GENERAL ENG THROTTLE LEVER POSITION:1 | Throttle position |

## Development Notes

### Building the .spb File
The SDK Project Editor compiles `simwidget_panel.xml` into `simwidget_panel.spb`. This binary file registers the panel with MSFS's toolbar system. Without it, the panel won't appear.

### Panel Sizing
MSFS 2024's panel system has quirks with auto-sizing. Fixed dimensions are set via CSS:
```css
ingame-ui#simwidget_panel {
    width: 420px !important;
    height: 700px !important;
}
```

### Known Limitations
- Panel position is fixed (no drag to move)
- Resize functionality disabled (causes rendering bugs)
- Close only via toolbar icon toggle

## Credits

- Built with MSFS 2024 SDK
- Panel structure based on [bymaximus/msfs2020-toolbar-window-template](https://github.com/bymaximus/msfs2020-toolbar-window-template)
- SVG injection technique from [parallel42/msfs-toolbar-interop](https://github.com/parallel42/msfs-toolbar-interop)

## License

MIT License - Feel free to modify and distribute.

## Version History

### v1.0
- Initial release
- Flight data display (altitude, speed, heading, V/S)
- Light controls (NAV, BCN, STRB, LDG, TAXI)
- System controls (parking brake, gear, flaps)
- Engine status display
- Local time display
