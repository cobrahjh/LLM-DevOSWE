<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Environment</title>
    <link rel="stylesheet" href="../shared/widget-common.css">
    <link rel="stylesheet" href="/ui/shared/settings-panel.css">
    <link rel="stylesheet" href="/ui/shared/widget-customizer.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button class="settings-btn" id="settings-btn" title="Settings">‚öôÔ∏è</button>
    <button class="compact-toggle" id="compact-toggle" title="Toggle compact mode">&#9638;</button>

    <div class="widget-container" id="widget-root">

        <!-- ============ FULL LAYOUT ============ -->
        <div class="ev-full" id="ev-full">
            <div class="sw-widget environment">
                <div class="sw-header">
                    <span class="sw-conn" id="conn"></span>
                    <span class="sw-header-title">ENVIRONMENT</span>
                </div>

                <div class="sw-content">
                    <!-- Time of Day Section -->
                    <div class="env-section">
                        <div class="env-section-header">TIME OF DAY</div>
                        <div class="env-time-display">
                            <div class="env-time-icon" id="time-icon">‚òÄÔ∏è</div>
                            <div class="env-time-value">
                                <span class="env-time-local" id="local-time">12:00</span>
                                <span class="env-time-label">LOCAL</span>
                            </div>
                            <div class="env-time-value">
                                <span class="env-time-zulu" id="zulu-time">12:00Z</span>
                                <span class="env-time-label">ZULU</span>
                            </div>
                        </div>
                        <div class="env-time-slider">
                            <input type="range" id="time-slider" min="0" max="1440" value="720" class="env-slider">
                            <div class="env-time-marks">
                                <span>00:00</span>
                                <span>06:00</span>
                                <span>12:00</span>
                                <span>18:00</span>
                                <span>24:00</span>
                            </div>
                        </div>
                        <div class="env-time-presets">
                            <button class="env-preset-btn" data-time="360" title="Dawn">üåÖ</button>
                            <button class="env-preset-btn" data-time="720" title="Noon">‚òÄÔ∏è</button>
                            <button class="env-preset-btn" data-time="1080" title="Dusk">üåá</button>
                            <button class="env-preset-btn" data-time="0" title="Midnight">üåô</button>
                        </div>
                    </div>

                    <!-- Simulation Rate Section -->
                    <div class="env-section">
                        <div class="env-section-header">SIMULATION RATE</div>
                        <div class="env-simrate">
                            <button class="env-rate-btn" id="rate-decrease">‚àí</button>
                            <div class="env-rate-display">
                                <span class="env-rate-value" id="sim-rate">1x</span>
                                <span class="env-rate-label">SPEED</span>
                            </div>
                            <button class="env-rate-btn" id="rate-increase">+</button>
                        </div>
                        <div class="env-rate-presets">
                            <button class="env-rate-preset" data-rate="0.25">¬ºx</button>
                            <button class="env-rate-preset" data-rate="0.5">¬Ωx</button>
                            <button class="env-rate-preset active" data-rate="1">1x</button>
                            <button class="env-rate-preset" data-rate="2">2x</button>
                            <button class="env-rate-preset" data-rate="4">4x</button>
                            <button class="env-rate-preset" data-rate="8">8x</button>
                        </div>
                    </div>

                    <!-- Weather Conditions Section - NEW -->
                    <div class="env-section">
                        <div class="env-section-header">WEATHER CONDITIONS</div>
                        <div class="env-wx-grid">
                            <div class="env-wx-cell">
                                <span class="env-wx-label">TEMP</span>
                                <span class="env-wx-value" id="wx-temp">--¬∞C</span>
                            </div>
                            <div class="env-wx-cell">
                                <span class="env-wx-label">QNH</span>
                                <span class="env-wx-value" id="wx-qnh">----</span>
                            </div>
                            <div class="env-wx-cell">
                                <span class="env-wx-label">VIS</span>
                                <span class="env-wx-value" id="wx-vis">--SM</span>
                            </div>
                            <div class="env-wx-cell">
                                <span class="env-wx-label">WIND</span>
                                <span class="env-wx-value" id="wx-wind">---/--</span>
                            </div>
                            <div class="env-wx-cell">
                                <span class="env-wx-label">D-ALT</span>
                                <span class="env-wx-value" id="wx-dalt">----</span>
                            </div>
                            <div class="env-wx-cell">
                                <span class="env-wx-label">CLOUD</span>
                                <span class="env-wx-value" id="wx-cloud">CLR</span>
                            </div>
                        </div>
                        <div class="env-wx-precip" id="wx-precip-bar" style="display:none;">
                            <span class="env-wx-precip-icon">üåßÔ∏è</span>
                            <span class="env-wx-precip-text" id="wx-precip-text">PRECIP: 0.0mm</span>
                        </div>
                        <button class="env-wx-capture" id="btn-capture-wx" title="Capture current weather as .WPR preset file">
                            üì∏ CAPTURE WEATHER
                        </button>
                    </div>

                    <!-- Weather Presets Section -->
                    <div class="env-section">
                        <div class="env-section-header">WEATHER PRESETS</div>
                        <div class="env-weather-current">
                            <div class="env-weather-display">
                                <span class="env-weather-icon" id="weather-icon">‚òÄÔ∏è</span>
                                <span class="env-weather-name" id="weather-name">Clear Skies</span>
                            </div>
                            <span class="env-weather-badge" title="Visual preview only - MSFS 2024 weather control limited">UI PREVIEW</span>
                        </div>
                        <div class="env-weather-grid">
                            <button class="env-weather-btn active" data-weather="clear" title="Clear Skies - Perfect VFR conditions">
                                <span class="env-weather-emoji">‚òÄÔ∏è</span>
                                <span class="env-weather-text">Clear</span>
                            </button>
                            <button class="env-weather-btn" data-weather="fewclouds" title="Few Clouds - 1-2 oktas cloud cover">
                                <span class="env-weather-emoji">üå§Ô∏è</span>
                                <span class="env-weather-text">Few Cld</span>
                            </button>
                            <button class="env-weather-btn" data-weather="scattered" title="Scattered Clouds - 3-4 oktas cloud cover">
                                <span class="env-weather-emoji">‚õÖ</span>
                                <span class="env-weather-text">Sctd</span>
                            </button>
                            <button class="env-weather-btn" data-weather="broken" title="Broken Clouds - 5-7 oktas cloud cover">
                                <span class="env-weather-emoji">üå•Ô∏è</span>
                                <span class="env-weather-text">Broken</span>
                            </button>
                            <button class="env-weather-btn" data-weather="overcast" title="Overcast - 8 oktas complete cover">
                                <span class="env-weather-emoji">‚òÅÔ∏è</span>
                                <span class="env-weather-text">OVC</span>
                            </button>
                            <button class="env-weather-btn" data-weather="rain" title="Rain - Light to moderate rain">
                                <span class="env-weather-emoji">üåßÔ∏è</span>
                                <span class="env-weather-text">Rain</span>
                            </button>
                            <button class="env-weather-btn" data-weather="storm" title="Thunderstorm - Heavy rain with lightning">
                                <span class="env-weather-emoji">‚õàÔ∏è</span>
                                <span class="env-weather-text">Storm</span>
                            </button>
                            <button class="env-weather-btn" data-weather="snow" title="Snow - Snowfall conditions">
                                <span class="env-weather-emoji">üå®Ô∏è</span>
                                <span class="env-weather-text">Snow</span>
                            </button>
                            <button class="env-weather-btn" data-weather="fog" title="Fog - Reduced visibility <1SM">
                                <span class="env-weather-emoji">üå´Ô∏è</span>
                                <span class="env-weather-text">Fog</span>
                            </button>
                        </div>
                    </div>

                    <!-- Quick Actions Section -->
                    <div class="env-section">
                        <div class="env-section-header">QUICK ACTIONS</div>
                        <div class="env-actions-row">
                            <button class="env-action-btn" id="btn-pause" title="Pause Simulation">
                                <span class="env-action-icon">‚è∏Ô∏è</span>
                                <span class="env-action-text">PAUSE</span>
                            </button>
                            <button class="env-action-btn" id="btn-slew" title="Toggle Slew Mode">
                                <span class="env-action-icon">‚úàÔ∏è</span>
                                <span class="env-action-text">SLEW</span>
                            </button>
                            <button class="env-action-btn" id="btn-refuel" title="Repair & Refuel">
                                <span class="env-action-icon">‚õΩ</span>
                                <span class="env-action-text">REFUEL</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============ COMPACT LAYOUT ============ -->
        <div class="ev-compact" id="ev-compact">
            <div class="ev-compact-row ev-compact-top">
                <span class="ev-compact-icon" id="ev-time-icon">‚òÄÔ∏è</span>
                <span class="ev-compact-time" id="ev-local">12:00L</span>
                <span class="ev-compact-wx" id="ev-wx-icon">‚òÄÔ∏è</span>
                <span class="ev-compact-wx-name" id="ev-wx-name">CLR</span>
            </div>
            <div class="ev-compact-row ev-compact-bottom">
                <div class="ev-compact-cell">
                    <span class="ev-compact-lbl">WIND</span>
                    <span class="ev-compact-val" id="ev-wind">---</span>
                </div>
                <div class="ev-compact-cell">
                    <span class="ev-compact-lbl">TEMP</span>
                    <span class="ev-compact-val" id="ev-temp">--&deg;C</span>
                </div>
                <div class="ev-compact-cell">
                    <span class="ev-compact-lbl">QNH</span>
                    <span class="ev-compact-val" id="ev-qnh">----</span>
                </div>
                <div class="ev-compact-cell">
                    <span class="ev-compact-lbl">VIS</span>
                    <span class="ev-compact-val" id="ev-vis">--SM</span>
                </div>
                <div class="ev-compact-cell">
                    <span class="ev-compact-lbl">PRECIP</span>
                    <span class="ev-compact-val" id="ev-precip">NONE</span>
                </div>
            </div>
        </div>

    </div> <!-- widget-container -->

    <!-- SimGlassBase Dependencies -->
    <script src="/ui/shared/safe-channel.js"></script>
    <script src="/ui/shared/themes.js"></script>
    <script src="/ui/shared/platform-utils.js"></script>
    <script src="/ui/shared/telemetry.js"></script>
    <script src="/ui/shared/settings-panel.js"></script>
    <script src="/ui/shared/feedback-section.js"></script>
    <script src="/ui/shared/widget-base.js"></script>

    <script src="/ui/shared/widget-customizer.js"></script>
    <script src="pane.js"></script>
    <script>
        const settings = new SettingsPanel();
        const customizer = new WidgetCustomizer({ widgetId: 'environment', settingsPanel: settings });
        document.getElementById('settings-btn').addEventListener('click', () => settings.toggle());
    </script>
  <script src="/ui/shared/help-panel.js"></script>
</body>
</html>
